import{d as pe,r as n,s as _e,w as K,o as be,G as T,g as $,a as u,c as f,j as S,b as e,h as v,i as r,F as H,x as fe,J as he,p as U,Z as ge,t as V,B as k,l as R,N as I,k as x,D as ye,S as j}from"./index-efb9783c.js";import{u as Ce}from"./instructor-8157c507.js";import{d as G}from"./vuedraggable.umd-ca67f12b.js";import{_ as J}from"./CommonModal.vue_vue_type_script_setup_true_lang-27a81b42.js";const ke={key:0,class:"mb-4 rounded bg-neutral-50 px-12 py-8"},xe=e("h2",{class:"mb-6 text-3xl font-bold text-neutral-900"},"建立常見問題",-1),Qe=e("p",{class:"mb-6"},"提供常見問題列表，這將會是提升服務體驗及轉換率的好方法",-1),Fe={key:1},Ve={class:"mb-4 flex items-center justify-between rounded bg-neutral-50 p-4"},Ie=e("h1",{class:"font-bold text-neutral-800"},"常見問題管理",-1),Ae={class:"rounded bg-neutral-50 p-6"},we={class:"relative mb-8 rounded border bg-neutral-50"},qe={class:"group flex h-14 items-center pe-12 ps-4"},Ee=e("i",{class:"material-icons js-draggable me-2 cursor-row-resize"},"sort",-1),Se=["disabled"],Te={class:"me-4"},$e=["onClick"],He=["onClick"],Ue=["onClick"],je=e("input",{checked:"",type:"checkbox",class:"peer absolute right-4 top-4 z-10 h-6 w-6 cursor-pointer opacity-0"},null,-1),Me=e("span",{class:"material-icons absolute right-4 top-4 rotate-0 transition-transform duration-300 peer-checked:rotate-180"},"keyboard_arrow_down",-1),Be={class:"border"},Ne={class:"flex items-center justify-between p-4"},ze={class:"flex items-center"},Pe=e("i",{class:"material-icons js-draggable me-2 cursor-row-resize"},"sort",-1),De={class:"me-3"},Ke={class:"flex items-center"},Re=["onClick"],Ge=["onClick"],Je={class:"mb-6"},Ze=["disabled"],Le={key:0},Oe={class:"mb-2"},We=e("label",{for:"questionTitle"},"標題",-1),Xe={class:"mb-6"},Ye=e("label",{for:"questionContent"},"內容",-1),et={key:1},tt={class:"mb-2"},ot=e("label",{for:"questionEditedTitle"},"標題",-1),lt={class:"mb-6"},st=e("label",{for:"questionEditedContent"},"內容",-1),at={class:"flex"},nt=["disabled"],vt=pe({__name:"CourseFAQEditView",setup(it){const Z=ye(),s=n(0),M=Ce(),{faqs:B}=_e(M),{getCourseFAQs:m,addCourseFAQCategory:L,editCourseFAQCategory:O,deleteCourseFAQCategory:W,addCourseFAQQuestion:X,editCourseFAQQuestion:Y,deleteCourseFAQQuestion:ee,FAQQuestionPublish:te,FAQQuestionUnpublish:oe}=M,y=n(!1),N=n(null),A=n("");K(y,()=>{A.value="",T(()=>{var a;(a=N.value)==null||a.resetForm()})});function le(){L({courseId:s.value,category:A.value}).then(()=>{m({courseId:s.value}),y.value=!1})}const h=n(0),C=n(0),_=n("");function se(a,t){_.value=t,C.value=a}function z(){O({courseId:s.value,categoryId:C.value,editedCategory:_.value}).then(()=>{C.value=0,_.value="",m({courseId:s.value})})}function ae(a){j.fire({icon:"warning",title:"確定刪除嗎？",showCancelButton:!0}).then(t=>{t.isConfirmed&&W({courseId:s.value,categoryId:a}).then(()=>{m({courseId:s.value})})})}const g=n(!0),b=n(!1),ne=n(null),w=n(""),q=n("");K(b,()=>{w.value="",q.value="",T(()=>{var a;(a=ne.value)==null||a.resetForm()})});function ie(){g.value?de():ce()}function ue(a){g.value=!0,h.value=a,b.value=!0}function de(){X({courseId:s.value,categoryId:h.value,questionTitle:w.value,questionContent:q.value}).then(()=>{m({courseId:s.value}),C.value=0,b.value=!1})}const Q=n(0),E=n(""),F=n("");function re(a,t,p,d){g.value=!1,h.value=a,Q.value=t,E.value=p,F.value=d,b.value=!0}function ce(){Y({courseId:s.value,categoryId:h.value,questionId:Q.value,editedQuestionTitle:E.value,editedQuestionContent:F.value}).then(()=>{m({courseId:s.value}),h.value=0,Q.value=0,F.value="",b.value=!1})}function ve(){ee({courseId:s.value,categoryId:h.value,questionId:Q.value}).then(()=>{m({courseId:s.value}),h.value=0,Q.value=0,b.value=!1})}const P=n(!1);function me(a,t,p){P.value=p,P.value?oe({courseId:s.value,categoryId:a,questionId:t}).then(d=>{d.data.status==!0&&(m({courseId:s.value}),j.fire({icon:"success",title:d.data.message}))}):te({courseId:s.value,categoryId:a,questionId:t}).then(d=>{d.data.status==!0&&(m({courseId:s.value}),j.fire({icon:"success",title:d.data.message}))})}return be(()=>{s.value=+Z.params.courseId,m({courseId:s.value}),T(()=>{document.querySelector("main").style.minHeight=`calc(100vh - ${document.querySelector("header").offsetHeight}px - ${document.querySelector("footer").offsetHeight}px)`})}),(a,t)=>{const p=$("ErrorMessage"),d=$("VField"),D=$("VForm");return u(),f(H,null,[S(B)[0]?(u(),f("div",Fe,[e("div",Ve,[Ie,e("button",{class:"btn-primary",onClick:t[1]||(t[1]=l=>y.value=!0)},"新增問題類別")]),e("div",Ae,[v(S(G),{class:"dragArea",list:S(B),"item-key":"id",handle:".js-draggable",group:{name:"g1"}},{item:r(({element:l})=>[e("div",we,[e("div",qe,[Ee,C.value==l.id?(u(),f(H,{key:0},[fe(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>_.value=o),id:"url",class:U(["form-control me-4 max-w-sm",{invalid:!_.value}]),onKeyup:t[3]||(t[3]=ge(o=>!!_.value&&z(),["enter"]))},null,34),[[he,_.value,void 0,{trim:!0}]]),e("button",{class:"me-4",disabled:_.value==="",onClick:t[4]||(t[4]=o=>z())}," 確定 ",8,Se),e("button",{onClick:t[5]||(t[5]=o=>C.value=0)},"取消")],64)):(u(),f(H,{key:1},[e("span",Te,V(l.title),1),e("i",{class:"material-icons me-4 hidden cursor-pointer text-red-400 group-hover:block",onClick:o=>ae(l.id)},"delete_outline",8,$e),e("i",{class:"material-icons hidden cursor-pointer text-neutral-400 group-hover:block",onClick:o=>se(l.id,l.title)},"edit",8,He)],64)),e("button",{class:"btn-secondary ms-auto",onClick:o=>ue(l.id)}," 新增問題內容 ",8,Ue)]),je,Me,(u(),k(S(G),{key:l.class_faq_questions.id,class:"max-h-0 overflow-hidden bg-neutral-100 transition-all duration-300 peer-checked:max-h-full",tag:"ul",group:{name:"g2"},list:l.class_faq_questions,"item-key":"id",handle:".js-draggable"},{item:r(({element:o})=>[e("li",Be,[e("div",Ne,[e("div",ze,[Pe,e("span",De,V(o.title),1),e("span",{class:U([[o.publish?"text-emerald-700":"text-neutral-600"],"max-h-8 min-w-19 rounded-full border bg-neutral-50 px-4 py-1 text-sm"])},V(o.publish?"已發布":"未發布"),3)]),e("div",Ke,[e("i",{class:"material-icons cursor-pointer pr-4 text-neutral-400",onClick:c=>re(l.id,o.id,o.title,o.content)},"edit",8,Re),e("i",{class:U([[o.publish?"text-emerald-700":"text-neutral-600"],"material-icons cursor-pointer"]),onClick:c=>me(l.id,o.id,o.publish)},"check_circle_outline",10,Ge)])])])]),_:2},1032,["list"]))])]),_:1},8,["list"])])])):(u(),f("div",ke,[xe,Qe,e("button",{class:"btn-primary",onClick:t[0]||(t[0]=l=>y.value=!0)},"新增問題類別")])),v(J,{modelValue:y.value,"onUpdate:modelValue":t[8]||(t[8]=l=>y.value=l)},{title:r(()=>[R("新增問題類別")]),default:r(()=>[v(D,{ref_key:"addFAQCategoryForm",ref:N,onSubmit:t[7]||(t[7]=l=>le())},{default:r(({meta:l})=>[e("div",Je,[v(d,{name:"FAQCategory",type:"text",rules:"required",modelValue:A.value,"onUpdate:modelValue":t[6]||(t[6]=o=>A.value=o),label:"問題類別"},{default:r(({field:o,errors:c,meta:i})=>[e("input",I({id:"FAQCategory",class:"form-control",placeholder:"輸入問題類別"},o,{class:{invalid:i.validated&&!!c.length}}),null,16),i.validated?(u(),k(p,{key:0,class:"invalid-feedback",name:"FAQCategory"})):x("",!0)]),_:2},1032,["modelValue"])]),e("button",{type:"submit",class:"btn-primary mx-auto block w-fit",disabled:!l.valid}," 新增 ",8,Ze)]),_:1},512)]),_:1},8,["modelValue"]),v(J,{modelValue:b.value,"onUpdate:modelValue":t[13]||(t[13]=l=>b.value=l)},{title:r(()=>[R(V(g.value?"新增問題":"編輯問題"),1)]),default:r(()=>[v(D,{ref:"questionInputForm",onSubmit:ie},{default:r(({meta:l})=>[g.value?(u(),f("div",Le,[e("div",Oe,[v(d,{name:"questionTitle",type:"text",rules:"required",modelValue:w.value,"onUpdate:modelValue":t[9]||(t[9]=o=>w.value=o),label:"問題標題"},{default:r(({field:o,errors:c,meta:i})=>[We,e("input",I({id:"questionTitle",class:"form-control",placeholder:"輸入問題標題"},o,{class:{invalid:i.validated&&!!c.length}}),null,16),i.validated?(u(),k(p,{key:0,class:"invalid-feedback",name:"title"})):x("",!0)]),_:2},1032,["modelValue"])]),e("div",Xe,[v(d,{name:"questionContent",type:"text",rules:"required",modelValue:q.value,"onUpdate:modelValue":t[10]||(t[10]=o=>q.value=o),label:"問題內容"},{default:r(({field:o,errors:c,meta:i})=>[Ye,e("textarea",I({id:"questionContent",class:"form-control",placeholder:"輸入問題內容"},o,{class:{invalid:i.validated&&!!c.length}}),null,16),i.validated?(u(),k(p,{key:0,class:"invalid-feedback",name:"question"})):x("",!0)]),_:2},1032,["modelValue"])])])):(u(),f("div",et,[e("div",tt,[v(d,{name:"questionEditedTitle",type:"text",rules:"required",modelValue:E.value,"onUpdate:modelValue":t[11]||(t[11]=o=>E.value=o),label:"問題標題"},{default:r(({field:o,errors:c,meta:i})=>[ot,e("input",I({id:"questionEditedTitle",class:"form-control",placeholder:"輸入問題標題"},o,{class:{invalid:i.validated&&!!c.length}}),null,16),i.validated?(u(),k(p,{key:0,class:"invalid-feedback",name:"title"})):x("",!0)]),_:2},1032,["modelValue"])]),e("div",lt,[v(d,{name:"questionEditedContent",type:"text",rules:"required",modelValue:F.value,"onUpdate:modelValue":t[12]||(t[12]=o=>F.value=o),label:"編輯問題內容"},{default:r(({field:o,errors:c,meta:i})=>[st,e("textarea",I({id:"questionEditedContent",class:"form-control",placeholder:"輸入問題內容"},o,{class:{invalid:i.validated&&!!c.length}}),null,16),i.validated?(u(),k(p,{key:0,class:"invalid-feedback",name:"question"})):x("",!0)]),_:2},1032,["modelValue"])])])),e("div",at,[e("button",{type:"submit",class:"btn-primary mx-auto block w-fit",disabled:!l.valid},V(g.value?"新增":"編輯"),9,nt),g.value?x("",!0):(u(),f("button",{key:0,class:"ms-auto text-red-500",onClick:ve}," 刪除 "))])]),_:1},512)]),_:1},8,["modelValue"])],64)}}});export{vt as default};
