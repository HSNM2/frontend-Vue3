import{d as U,r as a,o as z,g as H,a as l,c as n,b as e,h as x,i as g,k as b,F as v,n as k,p as w,B as I,t as c,q as J,j as K,v as O}from"./index-4e939a0e.js";import{R as D,g as Q}from"./userCourse-67094ec5.js";import{a as T,_ as W}from"./ReviewModal.vue_vue_type_script_setup_true_lang-c1a7d9ed.js";import{G as X}from"./user-b1976851.js";const Y={class:"relative flex h-full flex-col"},Z=e("h1",{class:"mb-6 bg-neutral-50 px-8 py-4 text-lg font-semibold text-neutral-800"},"我的學習",-1),ee={class:"h-full flex-1 bg-neutral-50 p-8"},te={class:"flex h-full flex-col justify-between"},se={key:0,class:"m-auto text-center"},ae=e("p",{class:"mb-8 text-lg font-bold text-neutral-800"},"還沒購買任何課程喔！",-1),oe=e("button",{class:"btn-primary mr-2"},"來去逛逛",-1),le={key:1,class:"grid grid-cols-1 gap-6 md:grid-cols-3"},ne={class:"cursor-pointer hover:shadow hover:shadow-md hover:shadow-neutral-150"},re={class:"overflow-hidden"},ce=["src"],ie={class:"h-56 border border-t-0 border-solid border-neutral-150 p-3"},ue={class:"flex h-full flex-col justify-between"},de={class:"line-clamp-2 text-lg font-bold text-primary-6"},_e={class:"flex flex-wrap items-center"},ve=e("p",{class:"pe-1 text-sm text-neutral-800"},"學習進度:",-1),he={class:"ps-1 text-xs"},pe={class:"flex flex-wrap"},fe=e("p",{class:"pe-1 text-sm text-neutral-800"},"單元進度:",-1),me={class:"text-sm text-neutral-800"},xe={class:"flex flex-wrap"},ge=e("p",{class:"pe-1 text-sm text-neutral-800"},"講師:",-1),be={class:"text-sm text-neutral-800"},ke={class:"flex items-center justify-between"},we={class:"flex items-center"},ye=e("p",{class:"pe-1 text-sm text-neutral-800"},"您的評分:",-1),Ce=["onClick"],Ve={class:"mt-8 flex items-center justify-end"},Re={class:"flex cursor-pointer items-center"},$e=["onClick"],Pe=U({__name:"CoursesView",setup(je){const{showError:h}=O(),p=a(0),P=a(0),q=a(100),E=a(0),A={bg:"bg-neutral-150",progress:"bg-neutral-500",height:"h-1"},d=a(!1),_=a({content:"",score:5}),i=a({}),y=()=>{X().then(t=>{i.value=t.data.data}).catch(t=>{h(t)})},F=t=>{p.value=t,G()},C=a(!1),G=()=>{D("get",p.value).then(t=>{t.data.message!=="使用者尚未評價該課程"&&(C.value=!0,_.value=t.data.data,_.value.score=Number(_.value.score)),d.value=!0}).catch(t=>{h(t)})},L=t=>{let o="post";C.value===!0&&(o="patch"),D(o,p.value,t).then(u=>{d.value=!1,y()}).catch(u=>{h(u)})},r=a(1),V=a(1),f=t=>{t<=0||t>=V.value||(r.value=t)};return z(()=>{y()}),(t,o)=>{var R,$,j,B,M,N;const u=H("router-link");return l(),n(v,null,[e("div",Y,[Z,e("div",ee,[e("div",te,[(($=(R=i.value)==null?void 0:R.courses)==null?void 0:$.length)===0?(l(),n("div",se,[ae,x(u,{to:"/courses"},{default:g(()=>[oe]),_:1})])):b("",!0),((B=(j=i.value)==null?void 0:j.courses)==null?void 0:B.length)!==0?(l(),n("div",le,[(l(!0),n(v,null,k((M=i.value)==null?void 0:M.courses,s=>(l(),n("div",{key:s.id,class:"relative"},[x(u,{to:`/learn/${s.id}`},{default:g(()=>[e("div",ne,[e("div",re,[e("img",{class:"block h-48 w-full object-cover duration-150 hover:scale-110",src:s.image_path,alt:""},null,8,ce)]),e("div",ie,[e("div",ue,[e("h3",de,c(s.title),1),e("div",null,[e("div",_e,[ve,x(W,{currentVal:E.value,minVal:P.value,maxVal:q.value,style:A},{default:g(({percent:m})=>[e("span",he,c(m+"%"),1)]),_:1},8,["currentVal","minVal","maxVal"])]),e("div",pe,[fe,e("p",me," 0完成/"+c(s.lessons.length+"個章節"),1)]),e("div",xe,[ge,e("p",be,c(s.teacherName),1)]),e("div",ke,[e("div",we,[ye,(l(),n(v,null,k(5,(m,S)=>e("span",{key:S,class:"material-icons text-base text-primary-3",onClick:J(Be=>F(s.id),["prevent"])},c(K(Q)(s.rating,S)),9,Ce)),64))])])])])])])]),_:2},1032,["to"])]))),128))])):b("",!0),e("div",Ve,[e("div",{class:w(["border",r.value-1<=0?"text-neutral-400":""])},[e("span",{class:"cursor-pointer px-2",onClick:o[0]||(o[0]=s=>f(r.value-1))},"<")],2),e("ul",Re,[(l(!0),n(v,null,k(V.value,s=>(l(),n("li",{key:s},[e("div",{class:w(["border",s===r.value?"bg-primary-4 text-white":""])},[e("span",{class:"px-2",onClick:m=>f(s)},c(s),9,$e)],2)]))),128))]),e("div",{class:w(["border",r.value+1>=((N=i.value)==null?void 0:N.totalPages)?"text-neutral-400":""])},[e("span",{class:"cursor-pointer px-2",onClick:o[1]||(o[1]=s=>f(r.value+1))},">")],2)])])])]),d.value?(l(),I(T,{key:0,tempRating:_.value,onCloseModal:o[2]||(o[2]=s=>d.value=!1),onSaveAction:L},null,8,["tempRating"])):b("",!0)],64)}}});export{Pe as default};
