import{_ as ee}from"./undo-fae16c0e.js";import{d as B,a as r,c as m,F as z,n as F,b as e,t as k,p as W,h as g,i as D,x as L,y as me,k as N,T as he,_ as ve,r as d,j as f,z as J,e as fe,m as _e,f as ye,s as be,A as j,w as K,o as ge,g as Q,l as T,B as X,C as xe,D as $e,u as Ce,S as Y,E as ke,G as we,R as Pe,v as Ve}from"./index-bcaa0858.js";import{_ as De}from"./ReviewModal.vue_vue_type_script_setup_true_lang-033acb2f.js";import{C as Te,_ as Ee}from"./ReviewView.vue_vue_type_script_setup_true_lang-6b14547d.js";import{a as Re,b as Se,C as je,c as Le}from"./userCourse-48ca7c5e.js";const Ne={class:"mb-10 flex h-80 flex-col gap-y-2 overflow-y-auto lg:min-h-full"},Be=["onClick"],Ie={class:"font-bold"},Ue={key:0,class:"flex flex-col gap-y-6 px-2 py-3"},Oe={class:"flex justify-between"},qe={class:"flex cursor-pointer gap-x-2"},Ae={class:"material-icons text-primary-5"},He=["onClick"],Me=B({__name:"ChapterView",props:{user:{type:Object},courseDetail:{type:Object,required:!0}},emits:["update-video-path"],setup(_,{emit:w}){const u=(y,p,i)=>{w("update-video-path",y,p,i)};return(y,p)=>{var i;return r(),m("ul",Ne,[(r(!0),m(z,null,F((i=_.courseDetail)==null?void 0:i.chapters,o=>(r(),m("li",{key:o.id},[e("div",{class:"flex cursor-pointer justify-between rounded-[10px] border border-primary-3 p-4 shadow shadow-primary-3",onClick:l=>o.isShow=!o.isShow},[e("h6",Ie,k(o.title),1),e("span",{class:W(["material-icons",o.isShow?"":"rotate-180"])}," expand_more ",2)],8,Be),g(he,{name:"slide"},{default:D(()=>[o.isShow?(r(),m("ul",Ue,[(r(!0),m(z,null,F(o.lessons,l=>(r(),m("li",{key:l.id},[e("div",Oe,[e("div",qe,[L(e("span",Ae," play_arrow ",512),[[me,l.isPlay===!0]]),e("p",{class:W(["text-primary-5",l.isPlay===!0?"font-bold":""]),onClick:h=>u(l.videoPath,o.id,l.id)},k(l.title),11,He)])])]))),128))])):N("",!0)]),_:2},1024)]))),128))])}}});const Z=ve(Me,[["__scopeId","data-v-42587a15"]]),Ge={class:"mb-16 grid grid-cols-12 gap-x-6 gap-y-4 px-3"},ze=fe('<div class="relative col-span-6 md:col-span-8"><input type="search" placeholder="搜尋關鍵字" class="h-10 w-full rounded-2.5xl border border-neutral-200 px-4 py-2"><span class="material-icons absolute right-6 top-1 text-lg text-neutral-600"> search </span></div><select class="col-span-6 h-10 rounded-2.5xl border border-neutral-200 px-4 py-2 md:col-span-4"><option value="">全部問題</option></select>',2),Fe={class:"col-span-12"},We={class:"mt-4 rounded-2.5xl border border-neutral-200 p-4 md:pt-4"},Je={class:""},Ke={class:"flex flex-col gap-y-2"},Qe={class:"flex items-center gap-x-4"},Xe=["src"],Ye={class:""},Ze={class:"mb-4 flex items-center gap-x-4"},et={class:""},tt=e("label",{for:"currentChapter",class:"text-primary-5"},"目前章節",-1),st=e("label",{for:"allChapter",class:"text-primary-5"},"全部章節",-1),at=e("div",{class:""},[e("textarea",{name:"",id:"",class:"w-full rounded-2.5xl border border-neutral-200 px-4 py-4 md:px-5",placeholder:"對本課程有疑問？請盡情發問吧！"})],-1),ot=e("div",{class:"mt-2 flex justify-end"},[e("button",{type:"button",class:"btn-primary w-[112px]"},"提問")],-1),lt=B({__name:"DiscussView",props:{user:{type:Object},courseDetail:{type:Object}},emits:["update-video-path"],setup(_,{emit:w}){const u=d("currentChapter");return(y,p)=>{var i,o,l,h;return r(),m("div",Ge,[ze,e("div",Fe,[e("div",We,[e("div",Je,[e("div",Ke,[e("div",Qe,[e("img",{class:"h-10 w-10 rounded-full",src:f(Re)((i=_.user)==null?void 0:i.avatarImagePath),alt:""},null,8,Xe),e("p",Ye,k(((o=_.user)==null?void 0:o.nickName)===null?(l=_.user)==null?void 0:l.name:(h=_.user)==null?void 0:h.nickName),1)]),e("div",Ze,[e("div",et,[L(e("input",{id:"currentChapter",class:"mr-1 h-3 w-3 appearance-none rounded-full outline outline-1 outline-offset-1 outline-primary-6 checked:bg-primary-5",type:"radio",value:"currentChapter","onUpdate:modelValue":p[0]||(p[0]=n=>u.value=n)},null,512),[[J,u.value]]),tt]),e("div",null,[L(e("input",{id:"allChapter",class:"mr-1 h-3 w-3 appearance-none rounded-full outline outline-1 outline-offset-1 outline-primary-6 checked:bg-primary-5",type:"radio",value:"allChapter","onUpdate:modelValue":p[1]||(p[1]=n=>u.value=n)},null,512),[[J,u.value]]),st])])])]),at,ot])])])}}}),nt={class:"container"},rt={class:"mt-6 md:mt-[52px]"},it={class:"grid grid-cols-12"},ct={class:"col-span-12 lg:col-span-8"},dt={class:"flex items-start justify-between gap-x-2"},ut={class:"text-heading-3xl text-primary-6"},pt={class:"lg:hidden"},mt=e("button",{type:"button",class:"btn-back-round"},[e("img",{class:"m-auto block",src:ee,alt:""})],-1),ht={class:"hidden lg:col-span-4 lg:block"},vt=e("button",{type:"button",class:"btn-back ms-auto flex w-36 items-center gap-x-2"},[e("img",{class:"",src:ee,alt:""}),T(" 返回 ")],-1),ft={class:"my-6 grid grid-cols-12 gap-6"},_t={key:0,class:"relative col-span-12 lg:col-span-8"},yt={class:"relative"},bt={class:"mt-6 border border-neutral-200 p-3"},gt={class:"flex items-center gap-x-4"},xt=e("span",null,"目前進度",-1),$t=e("span",{class:"material-icons pr-1 text-base text-secondary-2"}," import_contacts ",-1),Ct=e("span",{class:"material-icons pr-1 text-base text-primary-3"}," star ",-1),kt={class:"relative mb-4 pb-3 pt-[52px]"},wt={class:"flex justify-around gap-x-[19px] after:absolute after:bottom-0 after:left-0 after:h-px after:w-full after:bg-primary-3 after:content-[''] lg:justify-start"},Pt={class:"hidden lg:col-start-9 lg:col-end-13 lg:block lg:h-full"},St=B({__name:"LearnView",setup(_){const w=$e(),u=Ce(),{showError:y}=Ve(),p=_e(),{updateLoading:i}=p,o=ye(),{user:l}=be(o),h=d(!1),n=d(null),P=Number(w.params.id),te=d(0),se=d(100),ae=d(0),oe={bg:"bg-neutral-100",progress:"bg-secondary-2",height:"h-2"},le=()=>{Se({courseId:P}).then(t=>{if(t.data.isPublish===!0)ne();else return Y.fire({icon:"error",title:"未有此課程"}).finally(function(){u.push({path:"/courses"})})}).catch(t=>{y(t)})},ne=()=>{je({id:P}).then(t=>{t.data.isOwned===!1?Y.fire({icon:"error",title:"尚未購買此課程"}).then(function(){u.push({path:`/course/${P}`})}):re()}).catch(t=>{y(t)})},re=()=>{i(!0),Le(P).then(s=>{var t;n.value=s.data,(t=n.value)==null||t.data[0].chapters.forEach(c=>{c.isShow=!1,c.lessons.forEach(x=>{x.isPlay=!1})}),setTimeout(()=>{i(!1)},500)}).catch(s=>{y(s)})},V=d(!1),E=j(),ie=d(0),ce=s=>{E.value=s.player},b=(s,t)=>{},de=(s,t)=>{},ue=(s,t,c)=>{ie.value=s},pe=s=>{},C=j({crossorigin:"anonymous",sources:[{duration:24,type:"video/mp4",src:""}],fluid:!0,controls:!0,controlBar:{timeDivider:!0,durationDisplay:!0,remainingTimeDisplay:!1}}),I=(s,t,c)=>{var x;V.value=!1,h.value=!0,C.value.sources[0].src=s,ke(C),(x=n.value)==null||x.data[0].chapters.forEach($=>{$.id===t?$.lessons.forEach(v=>{v.id===c?v.isPlay=!0:v.isPlay=!1}):$.lessons.forEach(v=>{v.isPlay=!1})})};K(n,s=>{var t;if((t=s==null?void 0:s.data[0].chapters[0])!=null&&t.lessons[0].videoPath){V.value=!0;const c=s==null?void 0:s.data[0].chapters[0].lessons[0].videoPath;C.value.sources[0].src=c}}),K(C,s=>{we(()=>{V.value=!0,setTimeout(()=>{h.value=!1},1e3)})});const R=[{name:"課程內容",comp:Z,style:"lg:hidden"},{name:"課程討論",comp:lt,style:""},{name:"課程評價",comp:Ee,style:""}],U=j(R[0].comp),S=d(null),O=d(null),q=s=>{var t;S.value&&(S.value.scrollIntoView({behavior:"smooth"}),(t=O.value)==null||t.changeTabAction(s))},A=s=>{R.forEach(t=>{t.name===s&&(U.value=t.comp)})};return ge(()=>{A("課程討論"),le()}),(s,t)=>{var $,v,H;const c=Q("router-link"),x=Q("VLoading");return r(),m("main",null,[e("div",nt,[e("div",rt,[e("div",it,[e("div",ct,[e("div",dt,[e("h2",ut,k(($=n.value)==null?void 0:$.data[0].title),1),e("div",pt,[g(c,{to:`/course/${s.$route.params.id}`},{default:D(()=>[mt]),_:1},8,["to"])])])]),e("div",ht,[g(c,{to:`/course/${s.$route.params.id}`},{default:D(()=>[vt]),_:1},8,["to"])])]),e("div",ft,[V.value?(r(),m("div",_t,[e("div",yt,[g(x,{active:h.value,"onUpdate:active":t[0]||(t[0]=a=>h.value=a),"is-full-page":!1},null,8,["active"]),g(f(Pe),{ref:"videoPlayer",class:"video-player h-48 w-full md:h-96",options:f(C),playsinline:!0,crossorigin:"anonymous",onMounted:ce,onReady:pe,onPlay:t[1]||(t[1]=a=>b()),onPause:t[2]||(t[2]=a=>de()),onEnded:t[3]||(t[3]=a=>b()),onLoadeddata:t[4]||(t[4]=a=>b()),onWaiting:t[5]||(t[5]=a=>b()),onPlaying:t[6]||(t[6]=a=>b()),onCanplay:t[7]||(t[7]=a=>b()),onCanplaythrough:t[8]||(t[8]=a=>b()),onTimeupdate:t[9]||(t[9]=a=>{var M,G;return ue((M=f(E))==null?void 0:M.currentTime(),(G=f(E))==null?void 0:G.currentSrc())})},null,8,["options"])]),e("div",bt,[e("div",gt,[xt,g(De,{currentVal:ae.value,minVal:te.value,maxVal:se.value,style:oe},{default:D(({percent:a})=>[T(k(a+"%"),1)]),_:1},8,["currentVal","minVal","maxVal"]),e("button",{type:"button",class:"hidden rounded-2xl border border-secondary-2 px-6 py-1 lg:block",onClick:t[10]||(t[10]=a=>q("課程討論"))},[$t,T(" 課程討論 ")]),e("button",{type:"button",class:"hidden rounded-2xl border border-primary-3 px-6 py-1 lg:block",onClick:t[11]||(t[11]=a=>q("課程評價"))},[Ct,T(" 課程評價 ")])])]),e("div",{ref_key:"tabsElement",ref:S},[e("div",kt,[e("div",wt,[g(Te,{tabs:R,onChangeTabView:A,ref_key:"tabsCompRef",ref:O},null,512)])]),(r(),X(xe(f(U)),{isLogin:!0,user:f(l)?f(l):{},courseDetail:(v=n.value)==null?void 0:v.data[0],onUpdateVideoPath:I},null,40,["user","courseDetail"]))],512)])):N("",!0),e("div",Pt,[n.value?(r(),X(Z,{key:0,courseDetail:(H=n.value)==null?void 0:H.data[0],onUpdateVideoPath:I},null,8,["courseDetail"])):N("",!0)])])])])])}}});export{St as default};
