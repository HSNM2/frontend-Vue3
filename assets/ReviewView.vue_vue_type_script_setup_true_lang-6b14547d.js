import{d as z,r as o,M as U,o as P,w as J,a,c as n,n as v,F as u,D as G,p as $,b as e,t as c,l as E,j as _,_ as K,h as V,k as M,B as Q,v as X}from"./index-bcaa0858.js";import{g as h,a as Y,k as Z,R as W}from"./userCourse-48ca7c5e.js";import{_ as k,a as I}from"./ReviewModal.vue_vue_type_script_setup_true_lang-033acb2f.js";const ee=["onClick"],te={class:"hidden font-bold md:block"},se=z({__name:"CourseTabs",props:{tabs:{type:Object,required:!0}},emits:["changeTabView"],setup(y,{expose:N,emit:w}){const C=G(),m=C.name==="learn"?o("課程討論"):o("課程介紹"),l=i=>{m.value=i,w("changeTabView",i)},g=U(()=>i=>{if(m.value===i)return"active"}),p=o(window.innerWidth);return P(()=>{window.addEventListener("resize",function(){p.value=window.innerWidth})}),J(p,()=>{p.value>1296&&C.name==="learn"&&m.value==="課程內容"&&(m.value="課程討論",w("changeTabView",m.value))}),N({changeTabAction:l}),(i,T)=>(a(!0),n(u,null,v(y.tabs,d=>(a(),n("div",{key:d.name,class:$(d.style)},[e("button",{type:"button",class:$(["flex items-center px-2 text-base font-bold text-primary-4 md:px-8 md:text-[18px]",_(g)(d.name)]),onClick:F=>l(d.name)},[i.$route.name==="course"?(a(),n(u,{key:0},[e("span",te,c(d.name.substring(0,2)),1),E(" "+c(d.name.substring(2,4)),1)],64)):(a(),n(u,{key:1},[E(c(d.name),1)],64))],10,ee)],2))),128))}});const Le=K(se,[["__scopeId","data-v-e807351f"]]),ae={class:"mb-16 grid grid-cols-12 gap-x-6 gap-y-4 px-3"},ne={class:"rounded-2.5xl border border-neutral-200 px-[38px] py-5 lg:px-4"},le={class:"flex items-center justify-center gap-x-1.5"},re=e("span",{class:"material-icons text-4xl text-primary-3"}," star ",-1),oe={class:"text-xl font-bold"},ce={class:"text-base text-neutral-600"},ie={class:"my-4"},ue={class:"flex items-center justify-center gap-x-4"},de={class:""},me={class:"flex items-center justify-center gap-x-4"},pe={class:""},ve={class:"flex items-center justify-center gap-x-4"},_e={class:""},ge={class:"flex items-center justify-center gap-x-4"},xe={class:""},he={class:"flex items-center justify-center gap-x-4"},ye={class:""},fe={key:0,class:"col-span-9 h-20 bg-secondary-1 lg:h-80"},be=e("div",{class:"flex h-20 items-center justify-center lg:h-80"},[e("p",{class:"text-xl font-bold text-neutral-800"},"尚無評價")],-1),Ve=[be],ke={class:"flex flex-col gap-y-4 md:flex-row md:items-center md:justify-between md:gap-y-0"},we={class:"flex items-center gap-x-4"},Ce=["src"],Re={class:""},je={class:"flex items-center justify-between md:gap-x-4"},$e={class:"flex items-center"},Ne={class:"text-sm text-primary-4"},Te={class:"mt-4 md:ml-14"},Oe=z({__name:"ReviewView",props:{isLogin:{type:Boolean,required:!0},isOwnedCourse:{type:Boolean,required:!1},user:{type:Object},courseDetail:{type:Object,required:!0},courseID:{type:Number}},emits:["get-data","update-video-path"],setup(y,{emit:N}){const w=y,C=G(),{showError:m}=X(),l=o({}),g=t=>t/l.value.countRating*100,p=o(0),i=o(100),T=o(0),d=o(0),F=o(0),q=o(0),D=o(0),f={bg:"bg-neutral-150",progress:"bg-neutral-500",height:"h-1"},R=o(!1),B=Number(C.params.id),j=o({content:"",score:5}),L=()=>{Z(B).then(t=>{l.value=t.data,T.value=g(l.value.star5Count),d.value=g(l.value.star4Count),F.value=g(l.value.star3Count),q.value=g(l.value.star2Count),D.value=g(l.value.star1Count)}).catch(t=>{m(t)})},O=o(!1),S=()=>{w.isLogin===!0&&W("get",B).then(t=>{t.data.message!=="使用者尚未評價該課程"&&(O.value=!0,j.value=t.data.data,j.value.score=Number(j.value.score))}).catch(t=>{m(t)})},H=t=>{let x="post";O.value===!0&&(x="patch"),W(x,B,t).then(b=>{R.value=!1,L(),S(),N("get-data")}).catch(b=>{m(b)})};return P(()=>{L(),S()}),(t,x)=>{var b;return a(),n(u,null,[e("div",ae,[e("div",{class:$(["col-span-12",t.$route.name==="course"?"lg:col-span-3 lg:col-start-10":""])},[e("div",ne,[e("div",le,[re,e("p",oe,c(l.value.avgRating),1),e("p",ce,"/5.0("+c(l.value.countRating)+"則評價)",1)]),e("div",ie,[e("div",ue,[e("div",de,[(a(),n(u,null,v(5,(r,s)=>e("span",{key:s,class:"material-icons text-base text-primary-3"},c(_(h)("5",s)),1)),64))]),V(k,{currentVal:T.value,minVal:p.value,maxVal:i.value,style:f},null,8,["currentVal","minVal","maxVal"])]),e("div",me,[e("div",pe,[(a(),n(u,null,v(5,(r,s)=>e("span",{key:s,class:"material-icons text-base text-primary-3"},c(_(h)("4",s)),1)),64))]),V(k,{currentVal:d.value,minVal:p.value,maxVal:i.value,style:f},null,8,["currentVal","minVal","maxVal"])]),e("div",ve,[e("div",_e,[(a(),n(u,null,v(5,(r,s)=>e("span",{key:s,class:"material-icons text-base text-primary-3"},c(_(h)("3",s)),1)),64))]),V(k,{currentVal:F.value,minVal:p.value,maxVal:i.value,style:f},null,8,["currentVal","minVal","maxVal"])]),e("div",ge,[e("div",xe,[(a(),n(u,null,v(5,(r,s)=>e("span",{key:s,class:"material-icons text-base text-primary-3"},c(_(h)("2",s)),1)),64))]),V(k,{currentVal:q.value,minVal:p.value,maxVal:i.value,style:f},null,8,["currentVal","minVal","maxVal"])]),e("div",he,[e("div",ye,[(a(),n(u,null,v(5,(r,s)=>e("span",{key:s,class:"material-icons text-base text-primary-3"},c(_(h)("1",s)),1)),64))]),V(k,{currentVal:D.value,minVal:p.value,maxVal:i.value,style:f},null,8,["currentVal","minVal","maxVal"])])]),y.isLogin===!0&&y.isOwnedCourse===!0||t.$route.name==="learn"?(a(),n("button",{key:0,type:"button",class:"btn-primary mx-auto block px-4",onClick:x[0]||(x[0]=r=>R.value=!0)}," 對課程有心得？ 開始評價 ")):M("",!0)])],2),e("div",{class:$(["col-span-12",t.$route.name==="course"?"lg:col-span-9 lg:row-start-1":""])},[((b=l.value.ratings)==null?void 0:b.length)===0?(a(),n("div",fe,Ve)):(a(!0),n(u,{key:1},v(l.value.ratings,(r,s)=>(a(),n("div",{key:s,class:"mb-4 rounded-2.5xl border border-secondary-2 p-5"},[e("div",ke,[e("div",we,[e("img",{class:"h-10 w-10 rounded-full",src:_(Y)(r.imagePath),alt:""},null,8,Ce),e("p",Re,c(r.nickName===""?r.name:r.nickName),1)]),e("div",je,[e("div",$e,[(a(),n(u,null,v(5,(Fe,A)=>e("span",{key:A,class:"material-icons text-lg text-primary-3"},c(_(h)(r.score,A)),1)),64))]),e("p",Ne,c(r.date.slice(0,10)),1)])]),e("div",Te,[e("p",null,c(r.content),1)])]))),128))],2)]),R.value?(a(),Q(I,{key:0,tempRating:j.value,onSaveAction:H,onCloseModal:x[1]||(x[1]=r=>R.value=!1)},null,8,["tempRating"])):M("",!0)],64)}}});export{Le as C,Oe as _};
